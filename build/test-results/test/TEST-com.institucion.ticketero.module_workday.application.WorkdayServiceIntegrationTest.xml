<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="com.institucion.ticketero.module_workday.application.WorkdayServiceIntegrationTest" tests="4" skipped="0" failures="0" errors="0" timestamp="2025-12-08T11:54:16" hostname="PANCHOX" time="0.083">
  <properties/>
  <testcase name="whenStartNewDay_thenWorkdayIsActiveAndSaved()" classname="com.institucion.ticketero.module_workday.application.WorkdayServiceIntegrationTest" time="0.041"/>
  <testcase name="whenStartNewDayWhileAnotherIsActive_thenThrowException()" classname="com.institucion.ticketero.module_workday.application.WorkdayServiceIntegrationTest" time="0.017"/>
  <testcase name="whenEndCurrentDay_thenWorkdayIsEndedAndUpdated()" classname="com.institucion.ticketero.module_workday.application.WorkdayServiceIntegrationTest" time="0.018"/>
  <testcase name="whenEndDayWithNoActiveDay_thenThrowException()" classname="com.institucion.ticketero.module_workday.application.WorkdayServiceIntegrationTest" time="0.006"/>
  <system-out><![CDATA[2025-12-08T08:54:14.156-03:00  INFO 43732 --- [    Test worker] tc.postgres:16-alpine                    : Creating container for image: postgres:16-alpine
2025-12-08T08:54:14.218-03:00  INFO 43732 --- [    Test worker] tc.postgres:16-alpine                    : Container postgres:16-alpine is starting: 2a33d73c02ef054d140fb80121f02b0863bc18efe1d2a9386b790c789d3d4934
2025-12-08T08:54:15.635-03:00  INFO 43732 --- [    Test worker] tc.postgres:16-alpine                    : Container postgres:16-alpine started in PT1.4778134S
2025-12-08T08:54:15.635-03:00  INFO 43732 --- [    Test worker] tc.postgres:16-alpine                    : Container is started (JDBC URL: jdbc:postgresql://localhost:56064/test?loggerLevel=OFF)
2025-12-08T08:54:15.639-03:00  INFO 43732 --- [    Test worker] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.institucion.ticketero.module_workday.application.WorkdayServiceIntegrationTest]: WorkdayServiceIntegrationTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-12-08T08:54:15.646-03:00  INFO 43732 --- [    Test worker] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.institucion.ticketero.TicketeroApplication for test class com.institucion.ticketero.module_workday.application.WorkdayServiceIntegrationTest

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v3.2.5)

2025-12-08T08:54:15.663-03:00  INFO 43732 --- [    Test worker] c.i.t.m.a.WorkdayServiceIntegrationTest  : Starting WorkdayServiceIntegrationTest using Java 21.0.9 with PID 43732 (started by fgonzalez in C:\Users\fgonzalez\gestion-tickets)
2025-12-08T08:54:15.663-03:00 DEBUG 43732 --- [    Test worker] c.i.t.m.a.WorkdayServiceIntegrationTest  : Running with Spring Boot v3.2.5, Spring v6.1.6
2025-12-08T08:54:15.663-03:00  INFO 43732 --- [    Test worker] c.i.t.m.a.WorkdayServiceIntegrationTest  : The following 1 profile is active: "test"
2025-12-08T08:54:15.828-03:00  INFO 43732 --- [    Test worker] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-12-08T08:54:15.839-03:00  INFO 43732 --- [    Test worker] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 10 ms. Found 3 JPA repository interfaces.
2025-12-08T08:54:15.893-03:00  INFO 43732 --- [    Test worker] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 0 (http)
2025-12-08T08:54:15.894-03:00  INFO 43732 --- [    Test worker] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-12-08T08:54:15.894-03:00  INFO 43732 --- [    Test worker] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.20]
2025-12-08T08:54:15.924-03:00  INFO 43732 --- [    Test worker] o.a.c.c.C.[Tomcat-1].[localhost].[/]     : Initializing Spring embedded WebApplicationContext
2025-12-08T08:54:15.924-03:00  INFO 43732 --- [    Test worker] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 259 ms
Standard Commons Logging discovery in action with spring-jcl: please remove commons-logging.jar from classpath in order to avoid potential conflicts
2025-12-08T08:54:15.966-03:00  INFO 43732 --- [    Test worker] com.zaxxer.hikari.HikariDataSource       : HikariPool-2 - Starting...
2025-12-08T08:54:15.989-03:00  INFO 43732 --- [    Test worker] com.zaxxer.hikari.pool.HikariPool        : HikariPool-2 - Added connection org.postgresql.jdbc.PgConnection@6aa4a749
2025-12-08T08:54:15.989-03:00  INFO 43732 --- [    Test worker] com.zaxxer.hikari.HikariDataSource       : HikariPool-2 - Start completed.
2025-12-08T08:54:15.996-03:00  INFO 43732 --- [    Test worker] org.flywaydb.core.FlywayExecutor         : Database: jdbc:postgresql://localhost:56064/test (PostgreSQL 16.11)
2025-12-08T08:54:16.000-03:00  WARN 43732 --- [    Test worker] o.f.c.internal.database.base.Database    : Flyway upgrade recommended: PostgreSQL 16.11 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 15.
2025-12-08T08:54:16.008-03:00  INFO 43732 --- [    Test worker] o.f.c.i.s.JdbcTableSchemaHistory         : Schema history table "public"."flyway_schema_history" does not exist yet
2025-12-08T08:54:16.009-03:00  INFO 43732 --- [    Test worker] o.f.core.internal.command.DbValidate     : Successfully validated 2 migrations (execution time 00:00.005s)
2025-12-08T08:54:16.018-03:00  INFO 43732 --- [    Test worker] o.f.c.i.s.JdbcTableSchemaHistory         : Creating Schema History table "public"."flyway_schema_history" ...
2025-12-08T08:54:16.045-03:00  INFO 43732 --- [    Test worker] o.f.core.internal.command.DbMigrate      : Current version of schema "public": << Empty Schema >>
2025-12-08T08:54:16.051-03:00  INFO 43732 --- [    Test worker] o.f.core.internal.command.DbMigrate      : Migrating schema "public" to version "1 - initial schema"
2025-12-08T08:54:16.096-03:00  INFO 43732 --- [    Test worker] o.f.core.internal.command.DbMigrate      : Migrating schema "public" to version "2 - add workday table"
2025-12-08T08:54:16.108-03:00  INFO 43732 --- [    Test worker] o.f.core.internal.command.DbMigrate      : Successfully applied 2 migrations to schema "public", now at version v2 (execution time 00:00.031s)
2025-12-08T08:54:16.131-03:00  INFO 43732 --- [    Test worker] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-12-08T08:54:16.133-03:00  INFO 43732 --- [    Test worker] o.h.c.internal.RegionFactoryInitiator    : HHH000026: Second-level cache disabled
2025-12-08T08:54:16.137-03:00  INFO 43732 --- [    Test worker] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-12-08T08:54:16.190-03:00  INFO 43732 --- [    Test worker] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-12-08T08:54:16.205-03:00  INFO 43732 --- [    Test worker] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-12-08T08:54:16.305-03:00  WARN 43732 --- [    Test worker] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-12-08T08:54:16.314-03:00  INFO 43732 --- [    Test worker] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-12-08T08:54:16.478-03:00  INFO 43732 --- [    Test worker] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2025-12-08T08:54:16.494-03:00  INFO 43732 --- [    Test worker] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 56076 (http) with context path ''
2025-12-08T08:54:16.497-03:00 DEBUG 43732 --- [   scheduling-1] c.i.t.common.scheduling.ScheduledTasks   : Running scheduled job: checkForPreArrivalAlerts
2025-12-08T08:54:16.497-03:00  INFO 43732 --- [    Test worker] c.i.t.m.a.WorkdayServiceIntegrationTest  : Started WorkdayServiceIntegrationTest in 0.848 seconds (process running for 11.083)
Hibernate: 
    SELECT
        t.* 
    FROM
        (         SELECT
            *,
            RANK() OVER (PARTITION 
        BY
            attention_type 
        ORDER BY
            created_at ASC) as rnk         
        FROM
            tickets         
        WHERE
            status = 'PENDING'     ) t     
    WHERE
        t.rnk = ? 
2025-12-08T08:54:16.504-03:00 DEBUG 43732 --- [   scheduling-1] c.i.t.common.scheduling.ScheduledTasks   : Running scheduled job: assignNextAvailableTicket
Hibernate: 
    select
        e1_0.id,
        e1_0.full_name,
        e1_0.last_status_change,
        e1_0.module,
        e1_0.status 
    from
        executives e1_0 
    where
        e1_0.status=? 
        and ? in (select
            sat1_0.attention_type 
        from
            executive_attention_types sat1_0 
        where
            e1_0.id=sat1_0.executive_id) 
    order by
        e1_0.last_status_change 
    fetch
        first ? rows only
Hibernate: 
    select
        w1_0.id,
        w1_0.end_time,
        w1_0.start_time,
        w1_0.status 
    from
        workdays w1_0
Hibernate: 
    select
        sat1_0.executive_id,
        sat1_0.attention_type 
    from
        executive_attention_types sat1_0 
    where
        sat1_0.executive_id=?
Hibernate: 
    select
        t1_0.id,
        t1_0.attended_at,
        t1_0.attention_type,
        t1_0.closed_at,
        t1_0.created_at,
        t1_0.customer_id,
        t1_0.executive_id,
        t1_0.status,
        t1_0.telegram_chat_id,
        t1_0.ticket_number,
        t1_0.updated_at 
    from
        tickets t1_0 
    where
        t1_0.attention_type=? 
        and t1_0.status=? 
    order by
        t1_0.created_at 
    fetch
        first ? rows only
Hibernate: 
    select
        w1_0.id,
        w1_0.end_time,
        w1_0.start_time,
        w1_0.status 
    from
        workdays w1_0 
    where
        w1_0.status=? 
    order by
        w1_0.start_time desc 
    fetch
        first ? rows only
Hibernate: 
    select
        e1_0.id,
        e1_0.full_name,
        e1_0.last_status_change,
        e1_0.module,
        e1_0.status 
    from
        executives e1_0 
    where
        e1_0.status=? 
        and ? in (select
            sat1_0.attention_type 
        from
            executive_attention_types sat1_0 
        where
            e1_0.id=sat1_0.executive_id) 
    order by
        e1_0.last_status_change 
    fetch
        first ? rows only
Hibernate: 
    select
        sat1_0.executive_id,
        sat1_0.attention_type 
    from
        executive_attention_types sat1_0 
    where
        sat1_0.executive_id=?
Hibernate: 
    select
        t1_0.id,
        t1_0.attended_at,
        t1_0.attention_type,
        t1_0.closed_at,
        t1_0.created_at,
        t1_0.customer_id,
        t1_0.executive_id,
        t1_0.status,
        t1_0.telegram_chat_id,
        t1_0.ticket_number,
        t1_0.updated_at 
    from
        tickets t1_0 
    where
        t1_0.attention_type=? 
        and t1_0.status=? 
    order by
        t1_0.created_at 
    fetch
        first ? rows only
Hibernate: 
    select
        e1_0.id,
        e1_0.full_name,
        e1_0.last_status_change,
        e1_0.module,
        e1_0.status 
    from
        executives e1_0 
    where
        e1_0.status=? 
        and ? in (select
            sat1_0.attention_type 
        from
            executive_attention_types sat1_0 
        where
            e1_0.id=sat1_0.executive_id) 
    order by
        e1_0.last_status_change 
    fetch
        first ? rows only
Hibernate: 
    select
        sat1_0.executive_id,
        sat1_0.attention_type 
    from
        executive_attention_types sat1_0 
    where
        sat1_0.executive_id=?
Hibernate: 
    select
        t1_0.id,
        t1_0.attended_at,
        t1_0.attention_type,
        t1_0.closed_at,
        t1_0.created_at,
        t1_0.customer_id,
        t1_0.executive_id,
        t1_0.status,
        t1_0.telegram_chat_id,
        t1_0.ticket_number,
        t1_0.updated_at 
    from
        tickets t1_0 
    where
        t1_0.attention_type=? 
        and t1_0.status=? 
    order by
        t1_0.created_at 
    fetch
        first ? rows only
Hibernate: 
    select
        e1_0.id,
        e1_0.full_name,
        e1_0.last_status_change,
        e1_0.module,
        e1_0.status 
    from
        executives e1_0 
    where
        e1_0.status=? 
        and ? in (select
            sat1_0.attention_type 
        from
            executive_attention_types sat1_0 
        where
            e1_0.id=sat1_0.executive_id) 
    order by
        e1_0.last_status_change 
    fetch
        first ? rows only
Hibernate: 
    select
        t1_0.id,
        t1_0.attended_at,
        t1_0.attention_type,
        t1_0.closed_at,
        t1_0.created_at,
        t1_0.customer_id,
        t1_0.executive_id,
        t1_0.status,
        t1_0.telegram_chat_id,
        t1_0.ticket_number,
        t1_0.updated_at 
    from
        tickets t1_0 
    where
        t1_0.attention_type=? 
        and t1_0.status=? 
    order by
        t1_0.created_at 
    fetch
        first ? rows only
Hibernate: 
    insert 
    into
        workdays
        (end_time, start_time, status, id) 
    values
        (?, ?, ?, ?)
Hibernate: 
    select
        w1_0.id,
        w1_0.end_time,
        w1_0.start_time,
        w1_0.status 
    from
        workdays w1_0 
    where
        w1_0.id=?
Hibernate: 
    select
        w1_0.id,
        w1_0.end_time,
        w1_0.start_time,
        w1_0.status 
    from
        workdays w1_0
Hibernate: 
    delete 
    from
        workdays 
    where
        id=?
Hibernate: 
    select
        w1_0.id,
        w1_0.end_time,
        w1_0.start_time,
        w1_0.status 
    from
        workdays w1_0 
    where
        w1_0.status=? 
    order by
        w1_0.start_time desc 
    fetch
        first ? rows only
Hibernate: 
    insert 
    into
        workdays
        (end_time, start_time, status, id) 
    values
        (?, ?, ?, ?)
Hibernate: 
    select
        w1_0.id,
        w1_0.end_time,
        w1_0.start_time,
        w1_0.status 
    from
        workdays w1_0 
    where
        w1_0.status=? 
    order by
        w1_0.start_time desc 
    fetch
        first ? rows only
Hibernate: 
    select
        w1_0.id,
        w1_0.end_time,
        w1_0.start_time,
        w1_0.status 
    from
        workdays w1_0
Hibernate: 
    delete 
    from
        workdays 
    where
        id=?
Hibernate: 
    select
        w1_0.id,
        w1_0.end_time,
        w1_0.start_time,
        w1_0.status 
    from
        workdays w1_0 
    where
        w1_0.status=? 
    order by
        w1_0.start_time desc 
    fetch
        first ? rows only
Hibernate: 
    insert 
    into
        workdays
        (end_time, start_time, status, id) 
    values
        (?, ?, ?, ?)
Hibernate: 
    select
        w1_0.id,
        w1_0.end_time,
        w1_0.start_time,
        w1_0.status 
    from
        workdays w1_0 
    where
        w1_0.status=? 
    order by
        w1_0.start_time desc 
    fetch
        first ? rows only
Hibernate: 
    update
        workdays 
    set
        end_time=?,
        start_time=?,
        status=? 
    where
        id=?
Hibernate: 
    select
        w1_0.id,
        w1_0.end_time,
        w1_0.start_time,
        w1_0.status 
    from
        workdays w1_0 
    where
        w1_0.id=?
Hibernate: 
    select
        w1_0.id,
        w1_0.end_time,
        w1_0.start_time,
        w1_0.status 
    from
        workdays w1_0
Hibernate: 
    delete 
    from
        workdays 
    where
        id=?
Hibernate: 
    select
        w1_0.id,
        w1_0.end_time,
        w1_0.start_time,
        w1_0.status 
    from
        workdays w1_0 
    where
        w1_0.status=? 
    order by
        w1_0.start_time desc 
    fetch
        first ? rows only
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>
